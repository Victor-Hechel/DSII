<h1>Cadastrar Programa</h1>

<form method="post" class="form-horizontal" action="/protected/cadastrarComunicador" enctype="multipart/form-data">

	<div class="row">
		<div class="col-sm-offset-3 col-sm-6" id="fundo">
			<div class="form-group">
				<label for="nome" class="col-sm-3 control-label">Nome: </label>
					<div class="col-sm-8">
						<input type="text" name="nome" id="nome" class="form-control" placeholder="Digite o nome do comunicador..." onblur="verifica()" required>			
					</div>
			</div>
			<div class="form-group">
				<div class="col-sm-offset-3 col-sm-8">
					<input type="file" name="arquivo" accept="image/*" class="btn btn-default btn-block">
				</div>
			</div>
			<div class="form-group">
				<div class="col-sm-offset-3 col-sm-8">
					<input type="submit" id='btn' value="Cadastrar" class="btn btn-default btn-block">
				</div>
			</div>	
		</div>
	</div>
</form>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">
	document.querySelector("input[type=file]").addEventListener("change", e => {
		if(!e.target.files[0].type.startsWith("image")){
			document.querySelector("input[type=file]").value = "";
		}
	});

	function verifica(){
		const nome = document.getElementById("nome").value;
		const btn = document.getElementById("btn");

		btn.disabled = true;

		$.get("/protected/existeComunicador/" + nome, function(data){
			if (!JSON.parse(data)) {
				btn.disabled = false;
			}
		});

	}

</script>